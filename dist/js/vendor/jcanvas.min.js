!function(t,e,r){"object"==typeof module&&"object"==typeof module.exports?module.exports=function(t,e){return r(t,e)}:r(t,e)}("undefined"!=typeof window?window.jQuery:{},"undefined"!=typeof window?window:this,function(t,e){function r(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);return this}function n(){et(this,n.baseDefaults)}function i(t){return"string"===nt(t)}function s(t){return!isNaN(Z(t))&&!isNaN(tt(t))}function a(t){return t&&t.getContext?t.getContext("2d"):null}function o(t){var e,r,n;for(e in t)t.hasOwnProperty(e)&&(n=t[e],r=nt(n),"string"===r&&s(n)&&"text"!==e&&(t[e]=tt(n)));void 0!==t.text&&(t.text=String(t.text))}function l(t){return t=et({},t),t.masks=t.masks.slice(0),t}function h(t,e){var r;t.save(),r=l(e.transforms),e.savedTransforms.push(r)}function u(t,e,r,n){r[n]&&(it(r[n])?e[n]=r[n].call(t,r):e[n]=r[n])}function d(t,e,r){u(t,e,r,"fillStyle"),u(t,e,r,"strokeStyle"),e.lineWidth=r.strokeWidth,r.rounded?e.lineCap=e.lineJoin="round":(e.lineCap=r.strokeCap,e.lineJoin=r.strokeJoin,e.miterLimit=r.miterLimit),r.strokeDash||(r.strokeDash=[]),e.setLineDash&&e.setLineDash(r.strokeDash),e.webkitLineDash=r.strokeDash,e.lineDashOffset=e.webkitLineDashOffset=e.mozDashOffset=r.strokeDashOffset,e.shadowOffsetX=r.shadowX,e.shadowOffsetY=r.shadowY,e.shadowBlur=r.shadowBlur,e.shadowColor=r.shadowColor,e.globalAlpha=r.opacity,e.globalCompositeOperation=r.compositing,r.imageSmoothing&&(e.imageSmoothingEnabled=e.mozImageSmoothingEnabled=r.imageSmoothingEnabled)}function c(t,e,r){r.mask&&(r.autosave&&h(t,e),t.clip(),e.transforms.masks.push(r._args))}function g(t,e,r){r.closed&&e.closePath(),r.shadowStroke&&0!==r.strokeWidth?(e.stroke(),e.fill(),e.shadowColor="transparent",e.shadowBlur=0,e.stroke()):(e.fill(),"transparent"!==r.fillStyle&&(e.shadowColor="transparent"),0!==r.strokeWidth&&e.stroke()),r.closed||e.closePath(),r._transformed&&e.restore(),r.mask&&(t=v(t),c(e,t,r))}function f(t,e,r,n,i){r._toRad=r.inDegrees?at/180:1,r._transformed=!0,e.save(),r.fromCenter||r._centered||void 0===n||(void 0===i&&(i=n),r.x+=n/2,r.y+=i/2,r._centered=!0),r.rotate&&Y(e,r,null),1===r.scale&&1===r.scaleX&&1===r.scaleY||A(e,r,null),(r.translate||r.translateX||r.translateY)&&O(e,r,null)}function v(e){var r,n=vt.dataCache;return n._canvas===e&&n._data?r=n._data:(r=t.data(e,"jCanvas"),r||(r={canvas:e,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:null,cursor:t(e).css("cursor"),drag:{layer:null,dragging:!1},event:{type:null,x:null,y:null},events:{},transforms:l(yt),savedTransforms:[],animating:!1,animated:null,pixelRatio:1,scaled:!1},t.data(e,"jCanvas",r)),n._canvas=e,n._data=r),r}function y(t,e,r){for(var n in wt.events)wt.events.hasOwnProperty(n)&&(r[n]||r.cursors&&r.cursors[n])&&p(t,e,r,n);e.events.mouseout||(t.bind("mouseout.jCanvas",function(){var r,n=e.drag.layer;for(n&&(e.drag={},_(t,e,n,"dragcancel")),r=0;r<e.layers.length;r+=1)n=e.layers[r],n._hovered&&t.triggerLayerEvent(e.layers[r],"mouseout");t.drawLayers()}),e.events.mouseout=!0)}function p(t,e,r,n){wt.events[n](t,e),r._event=!0}function m(t,e,r){var n,i,s;if(r.draggable||r.cursors){for(n=["mousedown","mousemove","mouseup"],s=0;s<n.length;s+=1)i=n[s],p(t,e,r,i);r._event=!0}}function w(t,e,r,n){t=e.layer.names,n?void 0!==n.name&&i(r.name)&&r.name!==n.name&&delete t[r.name]:n=r,i(n.name)&&(t[n.name]=r)}function x(t,e,r,n){t=e.layer.groups;var i,s,a,o;if(n){if(void 0!==n.groups&&null!==r.groups)for(s=0;s<r.groups.length;s+=1)if(i=r.groups[s],e=t[i]){for(o=0;o<e.length;o+=1)if(e[o]===r){a=o,e.splice(o,1);break}0===e.length&&delete t[i]}}else n=r;if(void 0!==n.groups&&null!==n.groups)for(s=0;s<n.groups.length;s+=1)i=n.groups[s],e=t[i],e||(e=t[i]=[],e.name=i),void 0===a&&(a=e.length),e.splice(a,0,r)}function b(t,e,r,n,i){n[r]&&e._running&&!e._running[r]&&(e._running[r]=!0,n[r].call(t[0],e,i),e._running[r]=!1)}function _(e,r,n,i,s){if(!(n.disableEvents||n.intangible&&-1!==t.inArray(i,mt))){if("mouseout"!==i){var a;n.cursors&&(a=n.cursors[i]),-1!==t.inArray(a,pt.cursors)&&(a=pt.prefix+a),a&&e.css({cursor:a})}b(e,n,i,n,s),b(e,n,i,r.eventHooks,s),b(e,n,i,wt.eventHooks,s)}}function L(e,n,s,a){var l,h=n._layer?s:n;return n._args=s,(n.draggable||n.dragGroups)&&(n.layer=!0,n.draggable=!0),n._method||(n._method=a?a:n.method?t.fn[n.method]:n.type?t.fn[ft.drawings[n.type]]:function(){}),n.layer&&!n._layer?(s=t(e),a=v(e),l=a.layers,(null===h.name||i(h.name)&&void 0===a.layer.names[h.name])&&(o(n),h=new r(n),h.canvas=e,h.layer=!0,h._layer=!0,h._running={},h.data=null!==h.data?et({},h.data):{},h.groups=null!==h.groups?h.groups.slice(0):[],w(s,a,h),x(s,a,h),y(s,a,h),m(s,a,h),n._event=h._event,h._method===t.fn.drawText&&s.measureText(h),null===h.index&&(h.index=l.length),l.splice(h.index,0,h),n._args=h,_(s,a,h,"add"))):n.layer||o(n),h}function k(t,e){var r,n;for(n=0;n<pt.props.length;n+=1)r=pt.props[n],void 0!==t[r]&&(t["_"+r]=t[r],pt.propsObj[r]=!0,e&&delete t[r])}function C(t,e,r){var n,i,s,a;for(n in r)if(r.hasOwnProperty(n)&&(i=r[n],it(i)&&(r[n]=i.call(t,e,n)),"object"===nt(i)&&st(i))){for(s in i)i.hasOwnProperty(s)&&(a=i[s],void 0!==e[n]&&(e[n+"."+s]=e[n][s],r[n+"."+s]=a));delete r[n]}return r}function T(e){var r,n,i=[],s=1;return"transparent"===e?e="rgba(0, 0, 0, 0)":e.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&(n=U.head,r=n.style.color,n.style.color=e,e=t.css(n,"color"),n.style.color=r),e.match(/^rgb/gi)&&(i=e.match(/(\d+(\.\d+)?)/gi),e.match(/%/gi)&&(s=2.55),i[0]*=s,i[1]*=s,i[2]*=s,i[3]=void 0!==i[3]?tt(i[3]):1),i}function S(t){var e,r=3;for("array"!==nt(t.start)&&(e=t.start.slice(0),t.start=T(t.start),console.log(e,"=>",t.start),t.end=T(t.end)),t.now=[],1===t.start[3]&&1===t.end[3]||(r=4),e=0;e<r;e+=1)t.now[e]=t.start[e]+(t.end[e]-t.start[e])*t.pos,3>e&&(t.now[e]=ot(t.now[e]));1!==t.start[3]||1!==t.end[3]?t.now="rgba( "+t.now.join(",")+" )":(t.now.slice(0,3),t.now="rgb( "+t.now.join(",")+" )"),t.elem.nodeName?t.elem.style[t.prop]=t.now:t.elem[t.prop]=t.now}function P(t){return ft.touchEvents[t]&&(t=ft.touchEvents[t]),t}function R(t){wt.events[t]=function(e,r){function n(t){a.x=t.offsetX,a.y=t.offsetY,a.type=i,a.event=t,e.drawLayers({resetFire:!0}),t.preventDefault()}var i,s,a;a=r.event,i="mouseover"===t||"mouseout"===t?"mousemove":t,s=P(i),r.events[i]||(s!==i?e.bind(i+".jCanvas "+s+".jCanvas",n):e.bind(i+".jCanvas",n),r.events[i]=!0)}}function X(t,e,r){var n,i,s,a;(r=r._args)&&(t=v(t),n=t.event,null!==n.x&&null!==n.y&&(s=n.x*t.pixelRatio,a=n.y*t.pixelRatio,i=e.isPointInPath(s,a)||e.isPointInStroke&&e.isPointInStroke(s,a)),e=t.transforms,r.eventX=n.x,r.eventY=n.y,r.event=n.event,n=t.transforms.rotate,s=r.eventX,a=r.eventY,0!==n?(r._eventX=s*ut(-n)-a*ht(-n),r._eventY=a*ut(-n)+s*ht(-n)):(r._eventX=s,r._eventY=a),r._eventX/=e.scaleX,r._eventY/=e.scaleY,i&&t.intersecting.push(r),r.intersects=!!i)}function Y(t,e,r){e._toRad=e.inDegrees?at/180:1,t.translate(e.x,e.y),t.rotate(e.rotate*e._toRad),t.translate(-e.x,-e.y),r&&(r.rotate+=e.rotate*e._toRad)}function A(t,e,r){1!==e.scale&&(e.scaleX=e.scaleY=e.scale),t.translate(e.x,e.y),t.scale(e.scaleX,e.scaleY),t.translate(-e.x,-e.y),r&&(r.scaleX*=e.scaleX,r.scaleY*=e.scaleY)}function O(t,e,r){e.translate&&(e.translateX=e.translateY=e.translate),t.translate(e.translateX,e.translateY),r&&(r.translateX+=e.translateX,r.translateY+=e.translateY)}function D(t){for(;0>t;)t+=2*at;return t}function j(t,e,r,n){var i,s,a,o,l,h,u;r===n?u=h=0:(h=r.x,u=r.y),n.inDegrees||360!==n.end||(n.end=2*at),n.start*=r._toRad,n.end*=r._toRad,n.start-=at/2,n.end-=at/2,l=at/180,n.ccw&&(l*=-1),i=n.x+n.radius*ut(n.start+l),s=n.y+n.radius*ht(n.start+l),a=n.x+n.radius*ut(n.start),o=n.y+n.radius*ht(n.start),W(t,e,r,n,i,s,a,o),e.arc(n.x+h,n.y+u,n.radius,n.start,n.end,n.ccw),i=n.x+n.radius*ut(n.end+l),l=n.y+n.radius*ht(n.end+l),s=n.x+n.radius*ut(n.end),a=n.y+n.radius*ht(n.end),H(t,e,r,n,s,a,i,l)}function z(t,e,r,n,i,s,a,o){var l,h;n.arrowRadius&&!r.closed&&(h=dt(o-s,a-i),h-=at,t=r.strokeWidth*ut(h),l=r.strokeWidth*ht(h),r=a+n.arrowRadius*ut(h+n.arrowAngle/2),i=o+n.arrowRadius*ht(h+n.arrowAngle/2),s=a+n.arrowRadius*ut(h-n.arrowAngle/2),n=o+n.arrowRadius*ht(h-n.arrowAngle/2),e.moveTo(r-t,i-l),e.lineTo(a-t,o-l),e.lineTo(s-t,n-l),e.moveTo(a-t,o-l),e.lineTo(a+t,o+l),e.moveTo(a,o))}function W(t,e,r,n,i,s,a,o){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.startArrow&&z(t,e,r,n,i,s,a,o)}function H(t,e,r,n,i,s,a,o){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=!0),n.endArrow&&z(t,e,r,n,i,s,a,o)}function E(t,e,r,n){var i,s,a;for(i=2,W(t,e,r,n,n.x2+r.x,n.y2+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&e.moveTo(n.x1+r.x,n.y1+r.y);s=n["x"+i],a=n["y"+i],void 0!==s&&void 0!==a;)e.lineTo(s+r.x,a+r.y),i+=1;--i,H(t,e,r,n,n["x"+(i-1)]+r.x,n["y"+(i-1)]+r.y,n["x"+i]+r.x,n["y"+i]+r.y)}function G(t,e,r,n){var i,s,a,o,l;for(i=2,W(t,e,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&e.moveTo(n.x1+r.x,n.y1+r.y);s=n["x"+i],a=n["y"+i],o=n["cx"+(i-1)],l=n["cy"+(i-1)],void 0!==s&&void 0!==a&&void 0!==o&&void 0!==l;)e.quadraticCurveTo(o+r.x,l+r.y,s+r.x,a+r.y),i+=1;--i,H(t,e,r,n,n["cx"+(i-1)]+r.x,n["cy"+(i-1)]+r.y,n["x"+i]+r.x,n["y"+i]+r.y)}function I(t,e,r,n){var i,s,a,o,l,h,u,d;for(i=2,s=1,W(t,e,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),void 0!==n.x1&&void 0!==n.y1&&e.moveTo(n.x1+r.x,n.y1+r.y);a=n["x"+i],o=n["y"+i],l=n["cx"+s],h=n["cy"+s],u=n["cx"+(s+1)],d=n["cy"+(s+1)],void 0!==a&&void 0!==o&&void 0!==l&&void 0!==h&&void 0!==u&&void 0!==d;)e.bezierCurveTo(l+r.x,h+r.y,u+r.x,d+r.y,a+r.x,o+r.y),i+=1,s+=2;--i,s-=2,H(t,e,r,n,n["cx"+(s+1)]+r.x,n["cy"+(s+1)]+r.y,n["x"+i]+r.x,n["y"+i]+r.y)}function F(t,e,r){return e*=t._toRad,e-=at/2,r*ut(e)}function B(t,e,r){return e*=t._toRad,e-=at/2,r*ht(e)}function N(t,e,r,n){var i,s,a,o,l,h,u;for(r===n?l=o=0:(o=r.x,l=r.y),i=1,s=o=h=n.x+o,a=l=u=n.y+l,W(t,e,r,n,s+F(r,n.a1,n.l1),a+B(r,n.a1,n.l1),s,a),void 0!==n.x&&void 0!==n.y&&e.moveTo(s,a);s=n["a"+i],a=n["l"+i],void 0!==s&&void 0!==a;)o=h,l=u,h+=F(r,s,a),u+=B(r,s,a),e.lineTo(h,u),i+=1;H(t,e,r,n,o,l,h,u)}function J(t,e,r){isNaN(Z(r.fontSize))||(r.fontSize+="px"),e.font=r.fontStyle+" "+r.fontSize+" "+r.fontFamily}function q(e,r,n,i){var s,a;if(s=vt.propCache,s.text===n.text&&s.fontStyle===n.fontStyle&&s.fontSize===n.fontSize&&s.fontFamily===n.fontFamily&&s.maxWidth===n.maxWidth&&s.lineHeight===n.lineHeight)n.width=s.width,n.height=s.height;else{for(n.width=r.measureText(i[0]).width,a=1;a<i.length;a+=1)s=r.measureText(i[a]).width,s>n.width&&(n.width=s);r=e.style.fontSize,e.style.fontSize=n.fontSize,n.height=tt(t.css(e,"fontSize"))*i.length*n.lineHeight,e.style.fontSize=r}}function Q(t,e){var r,n,i,s,a,o=e.maxWidth,l=String(e.text).split("\n"),h=[];for(i=0;i<l.length;i+=1){if(s=l[i],a=s.split(" "),r=[],n="",1===a.length||t.measureText(s).width<o)r=[s];else{for(s=0;s<a.length;s+=1)t.measureText(n+a[s]).width>o&&(""!==n&&r.push(n),n=""),n+=a[s],s!==a.length-1&&(n+=" ");r.push(n)}h=h.concat(r.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return h}var $,U=e.document,V=e.Image,M=e.getComputedStyle,K=e.Math,Z=e.Number,tt=e.parseFloat,et=t.extend,rt=t.inArray,nt=function(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()},it=t.isFunction,st=t.isPlainObject,at=K.PI,ot=K.round,lt=K.abs,ht=K.sin,ut=K.cos,dt=K.atan2,ct=e.Array.prototype.slice,gt=t.event.fix,ft={},vt={dataCache:{},propCache:{},imageCache:{}},yt={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},pt={},mt="mousedown mousemove mouseup mouseover mouseout touchstart touchmove touchend".split(" "),wt={events:{},eventHooks:{},future:{}};n.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:!0,baseline:"middle",bringToFront:!1,ccw:!1,closed:!1,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:!0,crossOrigin:null,cursors:null,disableEvents:!1,draggable:!1,dragGroups:null,groups:null,data:null,dx:null,dy:null,end:360,eventX:null,eventY:null,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:!0,height:null,imageSmoothing:!0,inDegrees:!0,intangible:!1,index:null,letterSpacing:null,lineHeight:1,layer:!1,mask:!1,maxWidth:null,miterLimit:10,name:null,opacity:1,r1:null,r2:null,radius:0,repeat:"repeat",respectAlign:!1,restrictDragToAxis:null,rotate:0,rounded:!1,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:null,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeDash:null,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:null,sx:null,sy:null,text:"",translate:0,translateX:0,translateY:0,type:null,visible:!0,width:null,x:0,y:0},$=new n,r.prototype=$,wt.extend=function(e){return e.name&&(e.props&&et($,e.props),t.fn[e.name]=function n(t){var i,s,o,l;for(s=0;s<this.length;s+=1)i=this[s],(o=a(i))&&(l=new r(t),L(i,l,t,n),d(i,o,l),e.fn.call(i,o,l));return this},e.type&&(ft.drawings[e.type]=e.name)),t.fn[e.name]},t.fn.getEventHooks=function(){var t;return t={},0!==this.length&&(t=this[0],t=v(t),t=t.eventHooks),t},t.fn.setEventHooks=function(e){var r,n;for(r=0;r<this.length;r+=1)t(this[r]),n=v(this[r]),et(n.eventHooks,e);return this},t.fn.getLayers=function(t){var e,r,n,i,s=[];if(0!==this.length)if(e=this[0],r=v(e),r=r.layers,it(t))for(i=0;i<r.length;i+=1)n=r[i],t.call(e,n)&&s.push(n);else s=r;return s},t.fn.getLayer=function(t){var e,r,n,s;if(0!==this.length)if(e=this[0],r=v(e),e=r.layers,s=nt(t),t&&t.layer)n=t;else if("number"===s)0>t&&(t=e.length+t),n=e[t];else if("regexp"===s){for(r=0;r<e.length;r+=1)if(i(e[r].name)&&e[r].name.match(t)){n=e[r];break}}else n=r.layer.names[t];return n},t.fn.getLayerGroup=function(t){var e,r,n,i=nt(t);if(0!==this.length)if(e=this[0],"array"===i)n=t;else if("regexp"===i){for(r in e=v(e),e=e.layer.groups)if(r.match(t)){n=e[r];break}}else e=v(e),n=e.layer.groups[t];return n},t.fn.getLayerIndex=function(t){var e=this.getLayers();return t=this.getLayer(t),rt(t,e)},t.fn.setLayer=function(e,r){var n,i,a,l,h,u,d;for(i=0;i<this.length;i+=1)if(n=t(this[i]),a=v(this[i]),l=t(this[i]).getLayer(e)){w(n,a,l,r),x(n,a,l,r),o(r);for(h in r)r.hasOwnProperty(h)&&(u=r[h],d=nt(u),"object"===d&&st(u)?(l[h]=et({},u),o(l[h])):"array"===d?l[h]=u.slice(0):"string"===d?0===u.indexOf("+=")?l[h]+=tt(u.substr(2)):0===u.indexOf("-=")?l[h]-=tt(u.substr(2)):!isNaN(u)&&s(u)&&"text"!==h?l[h]=tt(u):l[h]=u:l[h]=u);y(n,a,l),m(n,a,l),!1===t.isEmptyObject(r)&&_(n,a,l,"change",r)}return this},t.fn.setLayers=function(e,r){var n,i,s,a;for(i=0;i<this.length;i+=1)for(n=t(this[i]),s=n.getLayers(r),a=0;a<s.length;a+=1)n.setLayer(s[a],e);return this},t.fn.setLayerGroup=function(e,r){var n,i,s,a;for(i=0;i<this.length;i+=1)if(n=t(this[i]),s=n.getLayerGroup(e))for(a=0;a<s.length;a+=1)n.setLayer(s[a],r);return this},t.fn.moveLayer=function(e,r){var n,i,s,a,o;for(i=0;i<this.length;i+=1)n=t(this[i]),s=v(this[i]),a=s.layers,(o=n.getLayer(e))&&(o.index=rt(o,a),a.splice(o.index,1),a.splice(r,0,o),0>r&&(r=a.length+r),o.index=r,_(n,s,o,"move"));return this},t.fn.removeLayer=function(e){var r,n,i,s,a;for(n=0;n<this.length;n+=1)r=t(this[n]),i=v(this[n]),s=r.getLayers(),(a=r.getLayer(e))&&(a.index=rt(a,s),s.splice(a.index,1),delete a._layer,w(r,i,a,{name:null}),x(r,i,a,{groups:null}),_(r,i,a,"remove"));return this},t.fn.removeLayers=function(e){var r,n,i,s,a,o;for(n=0;n<this.length;n+=1){for(r=t(this[n]),i=v(this[n]),s=r.getLayers(e),o=0;o<s.length;o+=1)a=s[o],r.removeLayer(a),--o;i.layer.names={},i.layer.groups={}}return this},t.fn.removeLayerGroup=function(e){var r,n,i,s;if(void 0!==e)for(n=0;n<this.length;n+=1)if(r=t(this[n]),v(this[n]),r.getLayers(),i=r.getLayerGroup(e))for(i=i.slice(0),s=0;s<i.length;s+=1)r.removeLayer(i[s]);return this},t.fn.addLayerToGroup=function(e,r){var n,i,s,a=[r];for(i=0;i<this.length;i+=1)n=t(this[i]),s=n.getLayer(e),s.groups&&(a=s.groups.slice(0),-1===rt(r,s.groups)&&a.push(r)),n.setLayer(s,{groups:a});return this},t.fn.removeLayerFromGroup=function(e,r){var n,i,s,a,o=[];for(i=0;i<this.length;i+=1)n=t(this[i]),s=n.getLayer(e),s.groups&&(a=rt(r,s.groups),-1!==a&&(o=s.groups.slice(0),o.splice(a,1),n.setLayer(s,{groups:o})));return this},pt.cursors=["grab","grabbing","zoom-in","zoom-out"],pt.prefix=function(){var t=M(U.documentElement,"");return"-"+(ct.call(t).join("").match(/-(moz|webkit|ms)-/)||""===t.OLink&&["","o"])[1]+"-"}(),t.fn.triggerLayerEvent=function(e,r){var n,i,s;for(i=0;i<this.length;i+=1)n=t(this[i]),s=v(this[i]),(e=n.getLayer(e))&&_(n,s,e,r);return this},t.fn.drawLayer=function(e){var r,n,i;for(r=0;r<this.length;r+=1)i=t(this[r]),(n=a(this[r]))&&(n=i.getLayer(e))&&n.visible&&n._method&&(n._next=null,n._method.call(i,n));return this},t.fn.drawLayers=function(e){var r,n,i,s,o,h,u,d,c,g,f=e||{};for((h=f.index)||(h=0),r=0;r<this.length;r+=1)if(e=t(this[r]),n=a(this[r])){for(u=v(this[r]),!1!==f.clear&&e.clearCanvas(),n=u.layers,o=h;o<n.length;o+=1)if(i=n[o],i.index=o,f.resetFire&&(i._fired=!1),d=e,c=i,s=o+1,c&&c.visible&&c._method&&(c._next=s?s:null,c._method.call(d,c)),i._masks=u.transforms.masks.slice(0),i._method===t.fn.drawImage&&i.visible){g=!0;break}if(g)break;i=u;var y=s=c=d=void 0;for(d=null,c=i.intersecting.length-1;0<=c;--c)if(d=i.intersecting[c],d._masks){for(y=d._masks.length-1;0<=y;--y)if(s=d._masks[y],!s.intersects){d.intersects=!1;break}if(d.intersects&&!d.intangible)break}if(d&&d.intangible&&(d=null),i=d,d=u.event,c=d.type,u.drag.layer){s=e;var y=u,p=c,m=void 0,w=void 0,x=void 0,b=x=void 0,L=void 0,x=m=m=x=void 0,x=y.drag,b=(w=x.layer)&&w.dragGroups||[],m=y.layers;if("mousemove"===p||"touchmove"===p){if(x.dragging||(x.dragging=!0,w.dragging=!0,w.bringToFront&&(m.splice(w.index,1),w.index=m.push(w)),w._startX=w.x,w._startY=w.y,w._endX=w._eventX,w._endY=w._eventY,_(s,y,w,"dragstart")),x.dragging)for(m=w._eventX-(w._endX-w._startX),x=w._eventY-(w._endY-w._startY),w.dx=m-w.x,w.dy=x-w.y,"y"!==w.restrictDragToAxis&&(w.x=m),"x"!==w.restrictDragToAxis&&(w.y=x),_(s,y,w,"drag"),m=0;m<b.length;m+=1)if(x=b[m],L=y.layer.groups[x],w.groups&&L)for(x=0;x<L.length;x+=1)L[x]!==w&&("y"!==w.restrictDragToAxis&&"y"!==L[x].restrictDragToAxis&&(L[x].x+=w.dx),"x"!==w.restrictDragToAxis&&"x"!==L[x].restrictDragToAxis&&(L[x].y+=w.dy))}else"mouseup"!==p&&"touchend"!==p||(x.dragging&&(w.dragging=!1,x.dragging=!1,_(s,y,w,"dragstop")),y.drag={})}s=u.lastIntersected,null===s||i===s||!s._hovered||s._fired||u.drag.dragging||(u.lastIntersected=null,s._fired=!0,s._hovered=!1,_(e,u,s,"mouseout"),e.css({cursor:u.cursor})),i&&(i[c]||ft.mouseEvents[c]&&(c=ft.mouseEvents[c]),i._event&&i.intersects&&(u.lastIntersected=i,!(i.mouseover||i.mouseout||i.cursors)||u.drag.dragging||i._hovered||i._fired||(i._fired=!0,i._hovered=!0,_(e,u,i,"mouseover")),i._fired||(i._fired=!0,d.type=null,_(e,u,i,c)),!i.draggable||i.disableEvents||"mousedown"!==c&&"touchstart"!==c||(u.drag.layer=i))),null!==i||u.drag.dragging||e.css({cursor:u.cursor}),o===n.length&&(u.intersecting.length=0,u.transforms=l(yt),u.savedTransforms.length=0)}return this},t.fn.addLayer=function(t){var e,n;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(n=new r(t),n.layer=!0,L(this[e],n,t));return this},pt.props=["width","height","opacity","lineHeight"],pt.propsObj={},t.fn.animateLayer=function(){function e(t,e,r){return function(){var n,i;for(i=0;i<pt.props.length;i+=1)n=pt.props[i],r[n]=r["_"+n];for(var s in r)r.hasOwnProperty(s)&&-1!==s.indexOf(".")&&delete r[s];e.animating&&e.animated!==r||t.drawLayers(),r._animating=!1,e.animating=!1,e.animated=null,h[4]&&h[4].call(t[0],r),_(t,e,r,"animateend")}}function r(t,e,r){return function(n,i){var s,a,o=!1;"_"===i.prop[0]&&(o=!0,i.prop=i.prop.replace("_",""),r[i.prop]=r["_"+i.prop]),-1!==i.prop.indexOf(".")&&(s=i.prop.split("."),a=s[0],s=s[1],r[a]&&(r[a][s]=i.now)),r._pos!==i.pos&&(r._pos=i.pos,r._animating||e.animating||(r._animating=!0,e.animating=!0,e.animated=r),e.animating&&e.animated!==r||t.drawLayers()),h[5]&&h[5].call(t[0],n,i,r),_(t,e,r,"animate",i),o&&(i.prop="_"+i.prop)}}var n,i,s,o,l,h=ct.call(arguments,0);for("object"===nt(h[2])?(h.splice(2,0,h[2].duration||null),h.splice(3,0,h[3].easing||null),h.splice(4,0,h[4].complete||null),h.splice(5,0,h[5].step||null)):(void 0===h[2]?(h.splice(2,0,null),h.splice(3,0,null),h.splice(4,0,null)):it(h[2])&&(h.splice(2,0,null),h.splice(3,0,null)),void 0===h[3]?(h[3]=null,h.splice(4,0,null)):it(h[3])&&h.splice(3,0,null)),i=0;i<this.length;i+=1)n=t(this[i]),(s=a(this[i]))&&(s=v(this[i]),(o=n.getLayer(h[0]))&&o._method!==t.fn.draw&&(l=et({},h[1]),l=C(this[i],o,l),k(l,!0),k(o),o.style=pt.propsObj,t(o).animate(l,{duration:h[2],easing:t.easing[h[3]]?h[3]:null,complete:e(n,s,o),step:r(n,s,o)}),_(n,s,o,"animatestart")));return this},t.fn.animateLayerGroup=function(e){var r,n,i,s,a=ct.call(arguments,0);for(n=0;n<this.length;n+=1)if(r=t(this[n]),i=r.getLayerGroup(e))for(s=0;s<i.length;s+=1)a[0]=i[s],r.animateLayer.apply(r,a);return this},t.fn.delayLayer=function(e,r){var n,i,s,a;for(r=r||0,i=0;i<this.length;i+=1)n=t(this[i]),s=v(this[i]),(a=n.getLayer(e))&&(t(a).delay(r),_(n,s,a,"delay"));return this},t.fn.delayLayerGroup=function(e,r){var n,i,s,a,o;for(r=r||0,i=0;i<this.length;i+=1)if(n=t(this[i]),s=n.getLayerGroup(e))for(o=0;o<s.length;o+=1)a=s[o],n.delayLayer(a,r);return this},t.fn.stopLayer=function(e,r){var n,i,s,a;for(i=0;i<this.length;i+=1)n=t(this[i]),s=v(this[i]),(a=n.getLayer(e))&&(t(a).stop(r),_(n,s,a,"stop"));return this},t.fn.stopLayerGroup=function(e,r){var n,i,s,a,o;for(i=0;i<this.length;i+=1)if(n=t(this[i]),s=n.getLayerGroup(e))for(o=0;o<s.length;o+=1)a=s[o],n.stopLayer(a,r);return this},function(e){var r;for(r=0;r<e.length;r+=1)t.fx.step[e[r]]=S}("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" ")),ft.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},ft.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},function(t){var e;for(e=0;e<t.length;e+=1)R(t[e])}("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend contextmenu".split(" ")),t.event.fix=function(e){var r,n;return e=gt.call(t.event,e),(r=e.originalEvent)&&(n=r.changedTouches,void 0!==e.pageX&&void 0===e.offsetX?(r=t(e.currentTarget).offset())&&(e.offsetX=e.pageX-r.left,e.offsetY=e.pageY-r.top):n&&(r=t(e.currentTarget).offset())&&(e.offsetX=n[0].pageX-r.left,e.offsetY=n[0].pageY-r.top)),e},ft.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"},t.fn.draw=function xt(e){var n,i,s=new r(e);if(ft.drawings[s.type]&&"function"!==s.type)this[ft.drawings[s.type]](e);else for(n=0;n<this.length;n+=1)t(this[n]),(i=a(this[n]))&&(s=new r(e),L(this[n],s,e,xt),s.visible&&s.fn&&s.fn.call(this[n],i,s));return this},t.fn.clearCanvas=function bt(t){var e,n,i=new r(t);for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(null===i.width||null===i.height?(n.save(),n.setTransform(1,0,0,1,0,0),n.clearRect(0,0,this[e].width,this[e].height),n.restore()):(L(this[e],i,t,bt),f(this[e],n,i,i.width,i.height),n.clearRect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),i._transformed&&n.restore()));return this},t.fn.saveCanvas=function _t(t){var e,n,i,s,o;for(e=0;e<this.length;e+=1)if(n=a(this[e]))for(s=v(this[e]),i=new r(t),L(this[e],i,t,_t),o=0;o<i.count;o+=1)h(n,s);return this},t.fn.restoreCanvas=function Lt(t){var e,n,i,s,o;for(e=0;e<this.length;e+=1)if(n=a(this[e]))for(s=v(this[e]),i=new r(t),L(this[e],i,t,Lt),o=0;o<i.count;o+=1){var h=n,u=s;0===u.savedTransforms.length?u.transforms=l(yt):(h.restore(),u.transforms=u.savedTransforms.pop())}return this},t.fn.rotateCanvas=function kt(t){var e,n,i,s;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(s=v(this[e]),i=new r(t),L(this[e],i,t,kt),i.autosave&&h(n,s),Y(n,i,s.transforms));return this},t.fn.scaleCanvas=function Ct(t){var e,n,i,s;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(s=v(this[e]),i=new r(t),L(this[e],i,t,Ct),i.autosave&&h(n,s),A(n,i,s.transforms));return this},t.fn.translateCanvas=function Tt(t){var e,n,i,s;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(s=v(this[e]),i=new r(t),L(this[e],i,t,Tt),i.autosave&&h(n,s),O(n,i,s.transforms));return this},t.fn.drawRect=function St(t){var e,n,i,s,o,l,h,u,c;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,St),i.visible&&(f(this[e],n,i,i.width,i.height),d(this[e],n,i),n.beginPath(),i.width&&i.height&&(s=i.x-i.width/2,o=i.y-i.height/2,(u=lt(i.cornerRadius))?(l=i.x+i.width/2,h=i.y+i.height/2,0>i.width&&(c=s,s=l,l=c),0>i.height&&(c=o,o=h,h=c),0>l-s-2*u&&(u=(l-s)/2),0>h-o-2*u&&(u=(h-o)/2),n.moveTo(s+u,o),n.lineTo(l-u,o),n.arc(l-u,o+u,u,3*at/2,2*at,!1),n.lineTo(l,h-u),n.arc(l-u,h-u,u,0,at/2,!1),n.lineTo(s+u,h),n.arc(s+u,h-u,u,at/2,at,!1),n.lineTo(s,o+u),n.arc(s+u,o+u,u,at,3*at/2,!1),i.closed=!0):n.rect(s,o,i.width,i.height)),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawArc=function Pt(t){var e,n,i;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,Pt),i.visible&&(f(this[e],n,i,2*i.radius),d(this[e],n,i),n.beginPath(),j(this[e],n,i,i),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawEllipse=function Rt(t){var e,n,i,s,o;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,Rt),i.visible&&(f(this[e],n,i,i.width,i.height),d(this[e],n,i),s=4/3*i.width,o=i.height,n.beginPath(),n.moveTo(i.x,i.y-o/2),n.bezierCurveTo(i.x-s/2,i.y-o/2,i.x-s/2,i.y+o/2,i.x,i.y+o/2),n.bezierCurveTo(i.x+s/2,i.y+o/2,i.x+s/2,i.y-o/2,i.x,i.y-o/2),X(this[e],n,i),i.closed=!0,g(this[e],n,i)));return this},t.fn.drawPolygon=function Xt(t){var e,n,i,s,o,l,h,u,c,v;for(e=0;e<this.length;e+=1)if((n=a(this[e]))&&(i=new r(t),L(this[e],i,t,Xt),i.visible)){for(f(this[e],n,i,2*i.radius),d(this[e],n,i),o=2*at/i.sides,l=o/2,s=l+at/2,h=i.radius*ut(l),n.beginPath(),v=0;v<i.sides;v+=1)u=i.x+i.radius*ut(s),c=i.y+i.radius*ht(s),n.lineTo(u,c),i.concavity&&(u=i.x+(h+-h*i.concavity)*ut(s+l),c=i.y+(h+-h*i.concavity)*ht(s+l),n.lineTo(u,c)),s+=o;X(this[e],n,i),i.closed=!0,g(this[e],n,i)}return this},t.fn.drawSlice=function Yt(e){var n,i,s,o,l;for(n=0;n<this.length;n+=1)t(this[n]),(i=a(this[n]))&&(s=new r(e),L(this[n],s,e,Yt),s.visible&&(f(this[n],i,s,2*s.radius),d(this[n],i,s),s.start*=s._toRad,s.end*=s._toRad,s.start-=at/2,s.end-=at/2,s.start=D(s.start),s.end=D(s.end),s.end<s.start&&(s.end+=2*at),o=(s.start+s.end)/2,l=s.radius*s.spread*ut(o),o=s.radius*s.spread*ht(o),s.x+=l,s.y+=o,i.beginPath(),i.arc(s.x,s.y,s.radius,s.start,s.end,s.ccw),i.lineTo(s.x,s.y),X(this[n],i,s),s.closed=!0,g(this[n],i,s)));return this},t.fn.drawLine=function At(t){var e,n,i;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,At),i.visible&&(f(this[e],n,i),d(this[e],n,i),n.beginPath(),E(this[e],n,i,i),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawQuadratic=function Ot(t){var e,n,i;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,Ot),i.visible&&(f(this[e],n,i),d(this[e],n,i),n.beginPath(),G(this[e],n,i,i),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawBezier=function Dt(t){var e,n,i;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,Dt),i.visible&&(f(this[e],n,i),d(this[e],n,i),n.beginPath(),I(this[e],n,i,i),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawVector=function jt(t){var e,n,i;for(e=0;e<this.length;e+=1)(n=a(this[e]))&&(i=new r(t),L(this[e],i,t,jt),i.visible&&(f(this[e],n,i),d(this[e],n,i),n.beginPath(),N(this[e],n,i,i),X(this[e],n,i),g(this[e],n,i)));return this},t.fn.drawPath=function zt(t){var e,n,i,s,o;for(e=0;e<this.length;e+=1)if((n=a(this[e]))&&(i=new r(t),L(this[e],i,t,zt),i.visible)){for(f(this[e],n,i),d(this[e],n,i),n.beginPath(),s=1;o=i["p"+s],void 0!==o;)o=new r(o),"line"===o.type?E(this[e],n,i,o):"quadratic"===o.type?G(this[e],n,i,o):"bezier"===o.type?I(this[e],n,i,o):"vector"===o.type?N(this[e],n,i,o):"arc"===o.type&&j(this[e],n,i,o),s+=1;X(this[e],n,i),g(this[e],n,i)}return this},t.fn.drawText=function Wt(e){var n,i,s,o,l,h,u,c,g,v;for(n=0;n<this.length;n+=1)if(t(this[n]),(i=a(this[n]))&&(s=new r(e),o=L(this[n],s,e,Wt),s.visible)){if(i.textBaseline=s.baseline,i.textAlign=s.align,J(this[n],i,s),l=null!==s.maxWidth?Q(i,s):s.text.toString().split("\n"),q(this[n],i,s,l),o&&(o.width=s.width,o.height=s.height),f(this[n],i,s,s.width,s.height),d(this[n],i,s),u=s.x,"left"===s.align?s.respectAlign?s.x+=s.width/2:u-=s.width/2:"right"===s.align&&(s.respectAlign?s.x-=s.width/2:u+=s.width/2),s.radius)for(u=tt(s.fontSize),null===s.letterSpacing&&(s.letterSpacing=u/500),o=0;o<l.length;o+=1){for(i.save(),i.translate(s.x,s.y),h=l[o],s.flipArcText&&(h=h.split(""),h.reverse(),h=h.join("")),c=h.length,i.rotate(-(at*s.letterSpacing*(c-1))/2),v=0;v<c;v+=1)g=h[v],0!==v&&i.rotate(at*s.letterSpacing),i.save(),i.translate(0,-s.radius),s.flipArcText&&i.scale(-1,-1),i.fillText(g,0,0),"transparent"!==s.fillStyle&&(i.shadowColor="transparent"),0!==s.strokeWidth&&i.strokeText(g,0,0),i.restore();s.radius-=u,s.letterSpacing+=u/(1e3*at),i.restore()}else for(o=0;o<l.length;o+=1)h=l[o],c=s.y+o*s.height/l.length-(l.length-1)*s.height/l.length/2,i.shadowColor=s.shadowColor,i.fillText(h,u,c),"transparent"!==s.fillStyle&&(i.shadowColor="transparent"),0!==s.strokeWidth&&i.strokeText(h,u,c);c=0,"top"===s.baseline?c+=s.height/2:"bottom"===s.baseline&&(c-=s.height/2),s._event&&(i.beginPath(),i.rect(s.x-s.width/2,s.y-s.height/2+c,s.width,s.height),X(this[n],i,s),i.closePath()),s._transformed&&i.restore()}return vt.propCache=s,this},t.fn.measureText=function(t){var e,n;return e=this.getLayer(t),(!e||e&&!e._layer)&&(e=new r(t)),(t=a(this[0]))&&(J(this[0],t,e),n=Q(t,e),q(this[0],t,e,n)),e},t.fn.drawImage=function Ht(e){function n(e,r,n,i,s){return function(){var a=t(e);null===i.width&&null===i.sWidth&&(i.width=i.sWidth=g.width),null===i.height&&null===i.sHeight&&(i.height=i.sHeight=g.height),s&&(s.width=i.width,s.height=i.height),null!==i.sWidth&&null!==i.sHeight&&null!==i.sx&&null!==i.sy?(null===i.width&&(i.width=i.sWidth),null===i.height&&(i.height=i.sHeight),i.cropFromCenter&&(i.sx+=i.sWidth/2,i.sy+=i.sHeight/2),0>i.sy-i.sHeight/2&&(i.sy=i.sHeight/2),i.sy+i.sHeight/2>g.height&&(i.sy=g.height-i.sHeight/2),0>i.sx-i.sWidth/2&&(i.sx=i.sWidth/2),i.sx+i.sWidth/2>g.width&&(i.sx=g.width-i.sWidth/2),f(e,r,i,i.width,i.height),d(e,r,i),r.drawImage(g,i.sx-i.sWidth/2,i.sy-i.sHeight/2,i.sWidth,i.sHeight,i.x-i.width/2,i.y-i.height/2,i.width,i.height)):(f(e,r,i,i.width,i.height),d(e,r,i),r.drawImage(g,i.x-i.width/2,i.y-i.height/2,i.width,i.height)),r.beginPath(),r.rect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),X(e,r,i),r.closePath(),i._transformed&&r.restore(),c(r,n,i),i.layer?_(a,n,s,"load"):i.load&&i.load.call(a[0],s),i.layer&&(s._masks=n.transforms.masks.slice(0),i._next&&a.drawLayers({clear:!1,resetFire:!0,index:i._next}))}}var i,s,o,l,h,u,g,y,p,m=vt.imageCache;for(s=0;s<this.length;s+=1)i=this[s],(o=a(this[s]))&&(l=v(this[s]),h=new r(e),u=L(this[s],h,e,Ht),h.visible&&(p=h.source,y=p.getContext,p.src||y?g=p:p&&(m[p]&&m[p].complete?g=m[p]:(g=new V,p.match(/^data:/i)||(g.crossOrigin=h.crossOrigin),g.src=p,m[p]=g)),g&&(g.complete||y?n(i,o,l,h,u)():(g.onload=n(i,o,l,h,u),g.src=g.src))));return this},t.fn.createPattern=function(e){function n(){l=i.createPattern(o,s.repeat),s.load&&s.load.call(u[0],l)}var i,s,o,l,h,u=this;return(i=a(u[0]))?(s=new r(e),h=s.source,it(h)?(o=t("<canvas />")[0],o.width=s.width,o.height=s.height,e=a(o),h.call(o,e),n()):(e=h.getContext,h.src||e?o=h:(o=new V,h.match(/^data:/i)||(o.crossOrigin=s.crossOrigin),o.src=h),o.complete||e?n():(o.onload=n,o.src=o.src))):l=null,l},t.fn.createGradient=function(t){var e,n,i,s,o,l,h,u,d=[];if(t=new r(t),e=a(this[0])){for(t.x1=t.x1||0,t.y1=t.y1||0,t.x2=t.x2||0,t.y2=t.y2||0,e=null!==t.r1&&null!==t.r2?e.createRadialGradient(t.x1,t.y1,t.r1,t.x2,t.y2,t.r2):e.createLinearGradient(t.x1,t.y1,t.x2,t.y2),o=1;void 0!==t["c"+o];o+=1)void 0!==t["s"+o]?d.push(t["s"+o]):d.push(null);
for(n=d.length,null===d[0]&&(d[0]=0),null===d[n-1]&&(d[n-1]=1),o=0;o<n;o+=1){if(null!==d[o]){for(h=1,u=0,i=d[o],l=o+1;l<n;l+=1){if(null!==d[l]){s=d[l];break}h+=1}i>s&&(d[l]=d[o])}else null===d[o]&&(u+=1,d[o]=i+(s-i)/h*u);e.addColorStop(d[o],t["c"+(o+1)])}}else e=null;return e},t.fn.setPixels=function Et(t){var e,n,i,s,o,l,h,u,d;for(n=0;n<this.length;n+=1)if(e=this[n],(i=a(e))&&(s=new r(t),L(e,s,t,Et),f(this[n],i,s,s.width,s.height),null!==s.width&&null!==s.height||(s.width=e.width,s.height=e.height,s.x=s.width/2,s.y=s.height/2),0!==s.width&&0!==s.height)){if(l=i.getImageData(s.x-s.width/2,s.y-s.height/2,s.width,s.height),h=l.data,d=h.length,s.each)for(u=0;u<d;u+=4)o={r:h[u],g:h[u+1],b:h[u+2],a:h[u+3]},s.each.call(e,o,s),h[u]=o.r,h[u+1]=o.g,h[u+2]=o.b,h[u+3]=o.a;i.putImageData(l,s.x-s.width/2,s.y-s.height/2),i.restore()}return this},t.fn.getCanvasImage=function(t,e){var r,n=null;return 0!==this.length&&(r=this[0],r.toDataURL&&(void 0===e&&(e=1),n=r.toDataURL("image/"+t,e))),n},t.fn.detectPixelRatio=function(r){var n,i,s,o,l,h,u;for(i=0;i<this.length;i+=1)n=this[i],t(this[i]),s=a(n),u=v(this[i]),u.scaled||(o=e.devicePixelRatio||1,l=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1,o/=l,1!==o&&(l=n.width,h=n.height,n.width=l*o,n.height=h*o,n.style.width=l+"px",n.style.height=h+"px",s.scale(o,o)),u.pixelRatio=o,u.scaled=!0,r&&r.call(n,o));return this},wt.clearCache=function(){for(var t in vt)vt.hasOwnProperty(t)&&(vt[t]={})},t.support.canvas=void 0!==t("<canvas />")[0].getContext,et(wt,{defaults:$,setGlobalProps:d,transformShape:f,detectEvents:X,closePath:g,setCanvasFont:J,measureText:q}),t.jCanvas=wt,t.jCanvasObject=r});